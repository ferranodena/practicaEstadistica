```{r}
data <- read.csv(".//base_dades_districtes.csv")
```
```{r}
# Scatter plot to study the correlation between square_feet and price (excluding 0 values)
library(ggplot2)

# Remove rows with missing or zero values in square_feet or price
filtered_data <- data[!is.na(data$square_feet) &
                      !is.na(data$price) &
                      data$square_feet > 0, ]

ggplot(filtered_data, aes(x = square_feet, y = price)) +
  geom_point(alpha = 0.6, color = "blue") +
  geom_smooth(method = "lm", se = TRUE, color = "red", linewidth = 1.2) +
  labs(
    title = "Correlation between Square Feet and Price",
    x = "Square Feet",
    y = "Price ($)"
  ) +
  theme_minimal()
```

```{r}
# Barplot to compare average price by neighbourhood
library(ggplot2)

# Remove rows with missing values in price or neighbourhood
filtered_data <- data[!is.na(data$price) & !is.na(data$neighbourhood), ]
# Calculate median price for labels
median_prices <- aggregate(price ~ neighbourhood, filtered_data, median)

ggplot(filtered_data, aes(x = reorder(neighbourhood, price, FUN = median), y = price/1000)) +
  geom_boxplot(fill = "skyblue", alpha = 0.7) +
  labs(
    title = "House Price Distribution by Neighbourhood",
    subtitle = "Boxplots showing price spread in each area",
    x = "Neighbourhood",
    y = "Price (Thousands $)"
  ) +
  theme_minimal() +
  theme(
    axis.text.x = element_text(angle = 45, hjust = 1, size = 10),
    plot.title = element_text(size = 14, face = "bold"),
    plot.subtitle = element_text(size = 12),
    axis.title = element_text(size = 12)
  )

```

```{r}
# Scatter plot: Price vs Amenities Count
filtered_data1 <- data[!is.na(data$price) & !is.na(data$amenities_count), ]
filtered_data2 <- data[!is.na(data$price) & !is.na(data$amenities_premium_count), ]

ggplot(filtered_data1, aes(x = amenities_count, y = price)) +
  geom_point(alpha = 0.6, color = "blue") +
  geom_smooth(method = "lm", se = TRUE, color = "red") +
  labs(
    title = "Price vs Amenities Count",
    x = "Amenities Count",
    y = "Price ($)"
  ) +
  theme_minimal()

# Scatter plot: Price vs Premium Amenities Count
ggplot(filtered_data2, aes(x = amenities_premium_count, y = price)) +
  geom_point(alpha = 0.6, color = "darkgreen") +
  geom_smooth(method = "lm", se = TRUE, color = "red") +
  labs(
    title = "Price vs Premium Amenities Count",
    x = "Premium Amenities Count",
    y = "Price ($)"
  ) +
  theme_minimal()

# Correlation calculation
cor1 <- cor(filtered_data1$price, filtered_data1$amenities_count)
cor2 <- cor(filtered_data2$price, filtered_data2$amenities_premium_count)
print(paste("Correlation between price and amenities count:", round(cor1, 2)))
print(paste("Correlation between price and premium amenities count:", round(cor2, 2)))
```

```{r}
# Scatter plot: Price vs Square Feet

filtered_data_sqft <- data[!is.na(data$price) &
                           !is.na(data$square_feet) &
                           data$square_feet > 0, ]

ggplot(filtered_data_sqft, aes(x = square_feet, y = price)) +
  geom_point(alpha = 0.6, color = "purple") +
  geom_smooth(method = "lm", se = TRUE, color = "red") +
  labs(
    title = "Price vs Square Feet",
    x = "Square Feet",
    y = "Price ($)"
  ) +
  theme_minimal()

# Correlation calculation
cor_sqft <- cor(filtered_data_sqft$price, filtered_data_sqft$square_feet)
print(paste("Correlation between price and square feet:", round(cor_sqft, 2)))
```
```{r}

# Scatter plot: Price vs Accommodate
filtered_data_acc <- data[!is.na(data$price) & !is.na(data$accommodates), ]

# Calculate Q1 and Q3 for price
Q1 <- quantile(filtered_data_acc$price, 0.25)
Q3 <- quantile(filtered_data_acc$price, 0.75)
IQR <- Q3 - Q1

# Filter out extreme outliers (more than 1.5 * IQR)
filtered_data_acc <- filtered_data_acc[filtered_data_acc$price <= (Q3 + 1.5 * IQR), ]

ggplot(filtered_data_acc, aes(x = accommodates, y = price)) +
  geom_point(alpha = 0.6, color = "orange") +
  geom_smooth(method = "lm", se = TRUE, color = "red") +
  labs(
    title = "Price vs Accommodates (Excluding Extreme Outliers)",
    x = "Accommodates (Number of Guests)",
    y = "Price ($)"
  ) +
  theme_minimal() +
  scale_y_continuous(limits = c(0, Q3 + 1.5 * IQR))

# Correlation calculation
cor_acc <- cor(filtered_data_acc$price, filtered_data_acc$accommodates)
print(paste("Correlation between price and accommodates:", round(cor_acc, 2)))
```